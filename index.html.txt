<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æ‹’çµ•èª˜æƒ‘å¤§ä½œæˆ°</title>
    
    <!-- å¼•å…¥ React å’Œ ReactDOM -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    
    <!-- å¼•å…¥ Babel ç”¨ä¾†è§£æ JSX -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    
    <!-- å¼•å…¥ Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>

    <!-- è¨­å®šå­—é«” -->
    <style>
        body { font-family: "Microsoft JhengHei", "Heiti TC", sans-serif; }
    </style>
</head>
<body class="bg-gradient-to-br from-blue-50 to-indigo-100 min-h-screen">
    <div id="root"></div>

    <script type="text/babel">
        // æ¨¡æ“¬çš„ Padlet URL
        const DEFAULT_PADLET_URL = "https://padlet.com/"; 

        const { useState } = React;

        function App() {
            const [gameState, setGameState] = useState('start'); // start, identity, scenario, result
            const [identity, setIdentity] = useState(null);
            const [currentScenario, setCurrentScenario] = useState(null);
            const [userResponse, setUserResponse] = useState('');
            const [padletUrl, setPadletUrl] = useState(DEFAULT_PADLET_URL);
            const [copied, setCopied] = useState(false);

            // èº«åˆ†è®Šé …è³‡æ–™åº«
            const variables = {
                family: [
                    { level: 'high', label: 'å®¶åº­æ”¯æŒåº¦é«˜', desc: 'å®¶äººå¾ˆé—œå¿ƒä½ ï¼Œå¸¸é™ªä½ èŠå¤©ã€‚', color: 'text-green-600' },
                    { level: 'mid', label: 'å®¶åº­æ”¯æŒåº¦æ™®é€š', desc: 'çˆ¶æ¯å¿™æ–¼å·¥ä½œï¼Œæ¯”è¼ƒå°‘æ™‚é–“ç›¸è™•ã€‚', color: 'text-yellow-600' },
                    { level: 'low', label: 'å®¶åº­æ”¯æŒåº¦ä½', desc: 'å®¶è£¡å¸¸æœ‰çˆ­åµï¼Œæ°£æ°›æ¯”è¼ƒç·Šå¼µã€‚', color: 'text-red-600' }
                ],
                health: [
                    { level: 'high', label: 'èº«é«”ç‹€æ³æ¥µä½³', desc: 'ä½ æ˜¯é‹å‹•å¥å°‡ï¼Œé«”åŠ›å……æ²›ã€‚', color: 'text-green-600' },
                    { level: 'mid', label: 'èº«é«”ç‹€æ³æ™®é€š', desc: 'å¶çˆ¾æœƒæ„Ÿå†’ï¼Œé«”åŠ›ä¸€èˆ¬ã€‚', color: 'text-yellow-600' },
                    { level: 'low', label: 'èº«é«”ç‹€æ³è¼ƒå·®', desc: 'ä½ æœ‰éæ•é«”è³ªæˆ–æ°£å–˜ï¼Œå®¹æ˜“ç–²ç´¯ã€‚', color: 'text-red-600' }
                ],
                money: [
                    { level: 'high', label: 'ç¶“æ¿Ÿå¯¬è£•', desc: 'æƒ³è¦çš„æ±è¥¿é€šå¸¸éƒ½èƒ½è²·åˆ°ã€‚', color: 'text-green-600' },
                    { level: 'mid', label: 'ç¶“æ¿Ÿå°åº·', desc: 'ç”Ÿæ´»ç„¡è™ï¼Œä½†ä¸èƒ½éš¨æ„äº‚èŠ±éŒ¢ã€‚', color: 'text-yellow-600' },
                    { level: 'low', label: 'ç¶“æ¿Ÿå›°é›£', desc: 'å®¶è£¡ç¶“æ¿Ÿå£“åŠ›å¤§ï¼Œé›¶ç”¨éŒ¢å¾ˆå°‘ã€‚', color: 'text-red-600' }
                ],
                mental: [
                    { level: 'high', label: 'å¿ƒç†å¥åº·æ­£å‘', desc: 'ä½ ç¸½æ˜¯æ¨‚è§€è‡ªä¿¡ï¼Œä¸æ€•æŒ«æŠ˜ã€‚', color: 'text-green-600' },
                    { level: 'mid', label: 'å¿ƒç†ç‹€æ³æ™®é€š', desc: 'å¶çˆ¾æœƒæ„Ÿåˆ°ç„¦æ…®ï¼Œä½†é‚„èƒ½èª¿é©ã€‚', color: 'text-yellow-600' },
                    { level: 'low', label: 'å¿ƒç†å£“åŠ›å¤§', desc: 'ä½ å¸¸è¦ºå¾—æ†‚é¬±ã€è‡ªå‘ï¼Œå®¹æ˜“ç·Šå¼µã€‚', color: 'text-red-600' }
                ],
                social: [
                    { level: 'high', label: 'äººéš›é—œä¿‚å¥½', desc: 'ä½ æ˜¯ç­ä¸Šçš„äººæ°£ç‹ï¼Œæœ‹å‹å¾ˆå¤šã€‚', color: 'text-green-600' },
                    { level: 'mid', label: 'äººéš›é—œä¿‚æ™®é€š', desc: 'æœ‰å¹¾å€‹å›ºå®šçš„å¥½æœ‹å‹ã€‚', color: 'text-yellow-600' },
                    { level: 'low', label: 'äººéš›é—œä¿‚å­¤ç«‹', desc: 'å¸¸è¦ºå¾—è¢«æ’æ“ ï¼Œæ²’ä»€éº¼æœ‹å‹ã€‚', color: 'text-red-600' }
                ]
            };

            // èª˜æƒ‘æƒ…å¢ƒè³‡æ–™åº«
            const scenarios = [
                {
                    type: 'tobacco',
                    title: 'å»æ‰€è£¡çš„ç§˜å¯†',
                    content: 'ä¸‹èª²æ™‚é–“ï¼Œä½ æœ€å¥½çš„æœ‹å‹æŠŠä½ æ‹‰åˆ°å»æ‰€è§’è½ï¼Œæ‹¿å‡ºä¸€å€‹ç™¼å…‰çš„é›»å­è¸ï¼Œèªªï¼šã€Œé€™å€‹æŠ½èµ·ä¾†æœ‰å“ˆå¯†ç“œçš„å‘³é“ï¼Œå¾ˆé…·å–”ï¼åæ­£è€å¸«ä¸æœƒç™¼ç¾ï¼Œä½ è©¦è©¦çœ‹ä¸€å£å°±å¥½ã€‚ã€',
                    image: 'ğŸ’¨'
                },
                {
                    type: 'alcohol',
                    title: 'è¦ªæˆšçš„èšé¤',
                    content: 'éå¹´å®¶æ—èšé¤ï¼Œä¸€ä½å–é†‰çš„é•·è¼©ä¸€ç›´æŠŠå•¤é…’æ¯ç£åˆ°ä½ å˜´é‚Šï¼Œå¤§è²èªªï¼šã€Œäº”å¹´ç´šäº†å•¦ï¼æ˜¯å¤§å­©å­äº†ï¼Œå–ä¸€é»é…’æœ‰ä»€éº¼é—œä¿‚ï¼Ÿä¸å–å°±æ˜¯ä¸çµ¦å”å”é¢å­å–”ï¼ã€',
                    image: 'ğŸº'
                },
                {
                    type: 'drug',
                    title: 'å¥‡æ€ªçš„ç³–æœ',
                    content: 'æ”¾å­¸å›å®¶çš„è·¯ä¸Šï¼Œä¸€å€‹çœ‹èµ·ä¾†å¾ˆå‹å–„çš„å¤§å“¥å“¥çµ¦ä½ ä¸€åŒ…åŒ…è£é®®è±”çš„ã€Œå’–å•¡åŒ…ã€ï¼Œèªªï¼šã€Œæˆ‘çœ‹ä½ å¿ƒæƒ…å¥½åƒä¸å¥½ï¼Œé€™å€‹å–äº†æœƒè®“ä½ å¿˜è¨˜ç…©æƒ±ï¼Œç²¾ç¥ç™¾å€å–”ï¼å…è²»é€ä½ ã€‚ã€',
                    image: 'ğŸ¬'
                },
                {
                    type: 'peer',
                    title: 'ä¸æƒ³è¢«æ’æ“ ',
                    content: 'ç­ä¸Šçš„é¢¨é›²äººç‰©å€‘åœ¨å…¬åœ’èšé›†ï¼Œä»–å€‘éƒ½åœ¨å˜—è©¦å¸é£ŸæŸç¨®ä¸æ˜ç²‰æœ«ã€‚ä»–å€‘çœ‹è‘—ä½ èªªï¼šã€Œå¦‚æœä½ ä¸æ•¢è©¦ï¼Œä»¥å¾Œå°±åˆ¥è·Ÿæˆ‘å€‘æ··äº†ï¼Œè†½å°é¬¼ã€‚ã€',
                    image: 'ğŸ˜'
                }
            ];

            const generateIdentity = () => {
                const getRandom = (arr) => arr[Math.floor(Math.random() * arr.length)];
                setIdentity({
                    family: getRandom(variables.family),
                    health: getRandom(variables.health),
                    money: getRandom(variables.money),
                    mental: getRandom(variables.mental),
                    social: getRandom(variables.social),
                });
                setGameState('identity');
            };

            const startScenario = () => {
                const randomScenario = scenarios[Math.floor(Math.random() * scenarios.length)];
                setCurrentScenario(randomScenario);
                setGameState('scenario');
                setUserResponse('');
                setCopied(false);
            };

            const copyToClipboard = () => {
                const textToCopy = `ã€èº«åˆ†æŒ‘æˆ°ã€‘\nå®¶åº­ï¼š${identity.family.label}\nå¿ƒç†ï¼š${identity.mental.label}\n\nã€é‡åˆ°èª˜æƒ‘ï¼š${currentScenario.title}ã€‘\næƒ…å¢ƒï¼š${currentScenario.content}\n\nã€æˆ‘çš„æ‹’çµ•ç­–ç•¥ã€‘\n${userResponse}`;
                
                if (navigator.clipboard && navigator.clipboard.writeText) {
                    navigator.clipboard.writeText(textToCopy)
                        .then(() => setCopied(true))
                        .catch(() => fallbackCopy(textToCopy));
                } else {
                    fallbackCopy(textToCopy);
                }
            };

            const fallbackCopy = (text) => {
                const textArea = document.createElement("textarea");
                textArea.value = text;
                document.body.appendChild(textArea);
                textArea.select();
                try {
                    document.execCommand('copy');
                    setCopied(true);
                } catch (err) {
                    console.error('Copy failed', err);
                }
                document.body.removeChild(textArea);
            };

            const IdentityCard = ({ icon, title, data }) => (
                <div className="bg-white p-3 rounded-lg shadow-sm border border-slate-200 flex items-start gap-3">
                    <div className="p-2 bg-slate-100 rounded-full text-xl">
                        {icon}
                    </div>
                    <div>
                        <h4 className={`font-bold text-sm ${data.color}`}>{title}ï¼š{data.label}</h4>
                        <p className="text-xs text-slate-500 mt-1">{data.desc}</p>
                    </div>
                </div>
            );

            return (
                <div className="flex justify-center items-center min-h-screen p-4 md:p-8">
                    <div className="max-w-3xl w-full bg-white rounded-3xl shadow-xl overflow-hidden border-4 border-white">
                        
                        {/* Header */}
                        <div className="bg-indigo-600 p-4 text-white text-center">
                            <h1 className="text-2xl md:text-3xl font-bold tracking-wider">ğŸ›¡ï¸ æ‹’çµ•èª˜æƒ‘å¤§ä½œæˆ°</h1>
                            <p className="text-indigo-200 text-sm mt-1">å®ˆè­·ä½ çš„æœªä¾†ï¼Œåšå‡ºè°æ˜é¸æ“‡</p>
                        </div>

                        {/* Content */}
                        <div className="p-6 md:p-8 min-h-[500px] flex flex-col">
                            
                            {/* 1. Start Screen */}
                            {gameState === 'start' && (
                                <div className="flex-1 flex flex-col items-center justify-center text-center space-y-6">
                                    <div className="text-6xl mb-4">ğŸ²</div>
                                    <h2 className="text-2xl font-bold text-slate-800">æº–å‚™å¥½æ¥å—æŒ‘æˆ°äº†å—ï¼Ÿ</h2>
                                    <p className="text-slate-600 max-w-md">
                                        åœ¨é€™å€‹éŠæˆ²ä¸­ï¼Œä½ æœƒéš¨æ©Ÿç²å¾—ä¸€å€‹èº«åˆ†ï¼Œä¸¦é‡åˆ°å„ç¨®ç”Ÿæ´»ä¸­çš„èª˜æƒ‘ã€‚
                                        <br/>
                                        è«‹è¨­èº«è™•åœ°æ€è€ƒï¼Œåœ¨é€™å€‹èº«åˆ†ä¸‹ï¼Œä½ æœƒå¦‚ä½•è°æ˜åœ°æ‹’çµ•ï¼Ÿ
                                    </p>
                                    
                                    <div className="w-full max-w-md bg-yellow-50 p-4 rounded-xl border border-yellow-200 text-left text-sm text-yellow-800 mb-4">
                                        <strong>è€å¸«çš„å°å®åš€ï¼š</strong>
                                        <br/>
                                        å¦‚æœä¸ç¢ºå®š Padlet ç¶²å€ï¼Œè«‹å…ˆç¢ºèªè€å¸«æä¾›çš„é€£çµã€‚
                                        <input 
                                            type="text" 
                                            value={padletUrl}
                                            onChange={(e) => setPadletUrl(e.target.value)}
                                            placeholder="åœ¨æ­¤è¼¸å…¥ Padlet ç¶²å€ (é¸å¡«)"
                                            className="mt-2 w-full p-2 border border-yellow-300 rounded bg-white text-slate-700 text-xs"
                                        />
                                    </div>

                                    <button 
                                        onClick={generateIdentity}
                                        className="bg-indigo-600 hover:bg-indigo-700 text-white font-bold py-4 px-10 rounded-full shadow-lg transform transition hover:scale-105 flex items-center gap-2 text-xl"
                                    >
                                        é–‹å§‹æŠ½å–èº«åˆ† â¡ï¸
                                    </button>
                                </div>
                            )}

                            {/* 2. Identity Reveal */}
                            {gameState === 'identity' && identity && (
                                <div className="flex-1 flex flex-col space-y-6">
                                    <div className="text-center">
                                        <h2 className="text-xl font-bold text-slate-800">é€™æ˜¯ä½ é€™å±€çš„èº«åˆ†</h2>
                                        <p className="text-slate-500 text-sm">æ¯å€‹äººçš„èµ·é»ä¸åŒï¼Œé€™æœƒå¦‚ä½•å½±éŸ¿ä½ çš„æ±ºå®šï¼Ÿ</p>
                                    </div>

                                    <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                                        <IdentityCard icon="ğŸ‘¤" title="å®¶åº­" data={identity.family} />
                                        <IdentityCard icon="â¤ï¸" title="å¥åº·" data={identity.health} />
                                        <IdentityCard icon="ğŸ’°" title="ç¶“æ¿Ÿ" data={identity.money} />
                                        <IdentityCard icon="ğŸ§ " title="å¿ƒç†" data={identity.mental} />
                                        <IdentityCard icon="ğŸ¤" title="äººéš›" data={identity.social} />
                                    </div>

                                    <div className="mt-auto flex justify-center pt-6">
                                        <button 
                                            onClick={startScenario}
                                            className="bg-indigo-600 hover:bg-indigo-700 text-white font-bold py-3 px-8 rounded-full shadow-lg flex items-center gap-2"
                                        >
                                            é‡åˆ°æŒ‘æˆ°äº†ï¼ ğŸ›¡ï¸
                                        </button>
                                    </div>
                                </div>
                            )}

                            {/* 3. Scenario & Response */}
                            {gameState === 'scenario' && currentScenario && (
                                <div className="flex-1 flex flex-col space-y-6">
                                    <div className="bg-slate-100 p-3 rounded-lg flex gap-4 text-xs text-slate-500 overflow-x-auto whitespace-nowrap">
                                        <span className="font-bold">ç›®å‰ç‹€æ…‹ï¼š</span>
                                        <span className={identity.family.color}>{identity.family.label}</span> | 
                                        <span className={identity.mental.color}>{identity.mental.label}</span> | 
                                        <span className={identity.social.color}>{identity.social.label}</span>
                                    </div>

                                    <div className="bg-red-50 border-l-4 border-red-500 p-6 rounded-r-lg">
                                        <div className="flex justify-between items-start">
                                            <h3 className="text-xl font-bold text-red-700 mb-2">{currentScenario.title}</h3>
                                            <span className="text-4xl">{currentScenario.image}</span>
                                        </div>
                                        <p className="text-slate-700 leading-relaxed text-lg">
                                            {currentScenario.content}
                                        </p>
                                    </div>

                                    <div className="flex-1">
                                        <label className="block text-slate-700 font-bold mb-2">
                                            è«‹è¼¸å…¥ä½ çš„æ‹’çµ•æ–¹å¼ï¼š
                                            <span className="text-sm font-normal text-slate-500 ml-2">(å¯ä»¥ä½¿ç”¨æ‹’çµ•æŠ€å·§ï¼šå …æŒç«‹å ´ã€å‘ŠçŸ¥ç†ç”±ã€è½‰ç§»è©±é¡Œ...)</span>
                                        </label>
                                        <textarea 
                                            value={userResponse}
                                            onChange={(e) => setUserResponse(e.target.value)}
                                            className="w-full h-32 p-4 border border-slate-300 rounded-xl focus:ring-2 focus:ring-indigo-500 focus:border-transparent resize-none text-lg"
                                            placeholder="æˆ‘æœƒèªª..."
                                        />
                                    </div>

                                    <div className="flex justify-end pt-4">
                                        <button 
                                            onClick={() => setGameState('result')}
                                            disabled={!userResponse.trim()}
                                            className={`py-3 px-8 rounded-full shadow-lg font-bold flex items-center gap-2 ${!userResponse.trim() ? 'bg-slate-300 cursor-not-allowed text-slate-500' : 'bg-green-600 hover:bg-green-700 text-white transform transition hover:scale-105'}`}
                                        >
                                            å®Œæˆä¸¦åˆ†äº« âœ…
                                        </button>
                                    </div>
                                </div>
                            )}

                            {/* 4. Result & Export */}
                            {gameState === 'result' && (
                                <div className="flex-1 flex flex-col items-center justify-center space-y-8 text-center">
                                    
                                    <div className="w-full bg-slate-50 rounded-xl p-6 border border-slate-200 text-left relative">
                                        <div className="absolute -top-3 left-6 bg-indigo-100 text-indigo-800 px-3 py-1 rounded-full text-xs font-bold uppercase tracking-wide">
                                            ä½ çš„å›æ‡‰å¡
                                        </div>
                                        <div className="space-y-3">
                                            <p className="text-sm text-slate-500 border-b pb-2">
                                                <span className="font-bold">èº«åˆ†èƒŒæ™¯ï¼š</span> {identity.family.label}ã€{identity.mental.label}...
                                            </p>
                                            <p className="text-lg font-medium text-red-600">
                                                <span className="text-slate-400 text-sm font-normal mr-2">é¢å°æƒ…å¢ƒï¼š</span>
                                                {currentScenario.title}
                                            </p>
                                            <p className="text-xl text-slate-800 font-bold bg-white p-4 rounded border border-slate-100 shadow-sm">
                                                ã€Œ{userResponse}ã€
                                            </p>
                                        </div>
                                    </div>

                                    <div className="flex flex-col gap-4 w-full max-w-md">
                                        <p className="text-slate-600">åšå¾—å¥½ï¼ç¾åœ¨å°‡ä½ çš„ç­”æ¡ˆåˆ†äº«åˆ° Padlet å§ã€‚</p>
                                        
                                        <button 
                                            onClick={copyToClipboard}
                                            className={`w-full py-4 rounded-xl font-bold flex items-center justify-center gap-2 border-2 transition-all
                                                ${copied 
                                                ? 'bg-green-100 border-green-500 text-green-700' 
                                                : 'bg-white border-indigo-200 text-indigo-600 hover:bg-indigo-50'
                                                }`}
                                        >
                                            {copied ? 'âœ… å·²è¤‡è£½å…§å®¹ï¼' : 'ğŸ“‹ ç¬¬ä¸€æ­¥ï¼šè¤‡è£½å…§å®¹'}
                                        </button>

                                        <a 
                                            href={padletUrl} 
                                            target="_blank" 
                                            rel="noopener noreferrer"
                                            className={`w-full py-4 rounded-xl font-bold flex items-center justify-center gap-2 text-white shadow-lg transition-all
                                                ${copied ? 'bg-indigo-600 hover:bg-indigo-700 transform hover:scale-105' : 'bg-slate-400 cursor-not-allowed pointer-events-none'}`}
                                        >
                                            ğŸ”— ç¬¬äºŒæ­¥ï¼šå‰å¾€ Padlet è²¼ä¸Š
                                        </a>
                                    </div>

                                    <button 
                                        onClick={() => setGameState('start')}
                                        className="mt-8 text-slate-400 hover:text-slate-600 flex items-center gap-2 text-sm"
                                    >
                                        ğŸ”„ å†ç©ä¸€æ¬¡
                                    </button>
                                </div>
                            )}

                        </div>
                    </div>
                </div>
            );
        }

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>